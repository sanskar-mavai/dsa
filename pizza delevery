#include <stdio.h>
#define MAX 20
#define INF 999

int a[MAX][MAX], visited[MAX];
int v = 0, e = 0;

void input() {
    int i, j, from, to, time;
    printf("Enter the number of locations (v): ");
    scanf("%d", &v);

    for(i = 0; i < v; i++) {
        visited[i] = 0;
        for(j = 0; j < v; j++) {
            if (i == j)
                a[i][j] = 0;
            else
                a[i][j] = INF;
        }
    }

    printf("\nEnter the number of edges (connections) (e): ");
    scanf("%d", &e);

    for(i = 0; i < e; i++) {
        printf("Enter the end locations of edge %d (1-%d): ", i + 1, v);
        scanf("%d %d", &from, &to);
        printf("Enter the travel time for this edge: ");
        scanf("%d", &time);

        if (from >= 1 && from <= v && to >= 1 && to <= v) {
            a[from-1][to-1] = time;
            a[to-1][from-1] = time;
        } else {
            printf("Invalid nodes; edge skipped.\n");
        }
    }
}

void display() {
    int i, j;
    if (v <= 0) {
        printf("No graph input. Please input first.\n");
        return;
    }

    printf("\nAdjacency Matrix (Travel Times):\n");
    for(i = 0; i < v; i++) {
        for(j = 0; j < v; j++) {
            if(a[i][j] == INF)
                printf("INF ");
            else
                printf("%3d ", a[i][j]);
        }
        printf("\n");
    }
}

void minimum_Delivery_Time() {
    int i, j, count, total_Time = 0, min, from = 0, to = 0;

    if (v <= 0) {
        printf("No graph input. Please input first.\n");
        return;
    }

    for (i = 0; i < v; i++)
        visited[i] = 0;

    visited[0] = 1;

    printf("\nMinimum Delivery Routes (Using Prim's Algorithm):\n");

    for(count = 0; count < v - 1; count++) {
        min = INF;
        from = -1;
        to = -1;

        for(i = 0; i < v; i++) {
            if(visited[i]) {
                for(j = 0; j < v; j++) {
                    if(!visited[j] && a[i][j] < min) {
                        min = a[i][j];
                        from = i;
                        to = j;
                    }
                }
            }
        }

        if (min == INF || to == -1) {
            printf("Graph is disconnected. Cannot connect all locations.\n");
            return;
        }

        visited[to] = 1;
        total_Time += min;
        printf("Deliver from Location %d -> Location %d with travel time: %d\n", from+1, to+1, min);
    }

    for (i = 0; i < v; i++) {
        if (!visited[i]) {
            printf("\nSome locations are unreachable. Delivery to all locations not possible.\n");
            return;
        }
    }

    printf("\nMinimum Total Delivery Time: %d\n", total_Time);
}

int main() {
    int choice;
    do {
        printf("\n========== PIZZA DELIVERY MIN TIME ================\n");
        printf("1. INPUT LOCATIONS AND EDGES\n2. DISPLAY MATRIX\n3. MINIMUM DELIVERY TIME\n4. EXIT\n");
        printf("Enter your choice: ");
        scanf("%d", &choice);

        switch(choice) {
            case 1: input(); break;
            case 2: display(); break;
            case 3: minimum_Delivery_Time(); break;
            case 4: printf("Exiting program...\n"); break;
            default: printf("Invalid choice!\n");
        }
    } while(choice != 4);

    return 0;
}


